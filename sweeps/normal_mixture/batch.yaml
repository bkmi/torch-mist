program: train.py
command:
  - ${env}
  - ${interpreter}
  - ${program}
  - fit
  - -c=config/experiments/normal_mixture/base.yaml
  - --data.num_workers=16
  - --trainer.default_root_dir=~/results
  - --trainer.logger=pytorch_lightning.loggers.WandbLogger
  - --trainer.accelerator=gpu
#  - --trainer.max_steps=10 #
#  - --trainer.gpus=0 #
#  - --trainer.accelerator=cpu #
  - ${args_no_hyphens}
method: grid
parameters:
  --model.mi_estimator.generative_estimator:
    values:
      - config/components/normal_mixture/mi_estimators/generative/BA.yaml
      - null
  --model.mi_estimator.discriminative_estimator:
    values:
      - config/components/normal_mixture/mi_estimators/discriminative/NWJ.yaml
      - config/components/normal_mixture/mi_estimators/discriminative/JS.yaml
      - config/components/normal_mixture/mi_estimators/discriminative/MINE.yaml
      - config/components/normal_mixture/mi_estimators/discriminative/SMILE.yaml
      - config/components/normal_mixture/mi_estimators/discriminative/InfoNCE.yaml
      - config/components/normal_mixture/mi_estimators/discriminative/NWJ+InfoNCE.yaml
      - config/components/normal_mixture/mi_estimators/discriminative/FLO.yaml
  --data.batch_size:
    values:
      - 8
      - 16
      - 32
      - 64
      - 128
      - 256
      - 512
  --seed:
    values:
      - 7
#      - 42
#      - 123

