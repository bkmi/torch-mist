program: train.py
command:
  - ${env}
  - ${interpreter}
  - ${program}
  - fit
  - -c=config/experiments/normal_mi_estimation.yaml
  - --data.num_workers=16
  - --data.batch_size=64
  - --trainer.default_root_dir=~/results
  - --trainer.logger=pytorch_lightning.loggers.WandbLogger
  - --trainer.accelerator=gpu
#  - --trainer.max_epochs=1
#  - --trainer.gpus=0
#  - --trainer.accelerator=cpu
  - ${args_no_hyphens}
method: grid
parameters:
  --model.mi_estimator.class_path:
    values:
      - core.models.mi_estimator.NWJ
      - core.models.mi_estimator.MINE
      - core.models.mi_estimator.JS
  --model.mi_estimator.proposal:
    values:
      - ""
      - config/components/models/proposals/transformed_normal.yaml
  --model.mi_estimator.predictor:
    values:
      - ""
      - config/components/models/predictors/conditional_categorical.yaml
  --model.mi_estimator.neg_samples:
    values:
      - 1
      - 2
      - 4
      - 8
      - 16
      - 32
#      - 64
  --seed:
    values:
      - 7
#      - 42
#      - 123

