data: ../../components/normal_mixture/data/sign.yaml

model:
  class_path: core.task.InfoMax
  init_args:
    mi_estimator:
      class_path: core.models.mi_estimator.HybridMutualInformationEstimator
      init_args:
        generative_estimator: ../../components/normal_mixture/mi_estimators/generative/ABC.yaml
    optimizer_class: torch.optim.Adam
    optimizer_init_args:
      lr: 5e-4
#    lr_scheduler_class: core.optim.lr_scheduler.WarmupScheduler
#    lr_scheduler_init_args:
#      warmup_steps: 10000
#      total_steps: 100000
#    lr_scheduler_params:
#      frequency: 1
#      interval: step


trainer:
  max_steps: 100000
  callbacks:
    - class_path: pytorch_lightning.callbacks.LearningRateMonitor
    - class_path: core.callbacks.VarianceLogCallback
      init_args:
          key: ["mi/value", "mi/grad", "mi/gen/value", "mi/gen/grad", "mi/dis/value", "mi/dis/grad"]
