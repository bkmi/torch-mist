# @package _global_
defaults:
  - /data: multimixture
  - /mi_estimator: ???

seed: 42

metadata:
  x_dim: 5
  y_dim: 5
  n_train_samples: 100000
  n_test_samples: 100000

params:
  hidden_dims: [128, 128, 64]

  # Discriminative estimator parameters
  neg_samples: 1

  # Generative estimator parameters
  marginal_transform_name: spline_autoregressive
  joint_transform_name: spline_autoregressive
  conditional_transform_name: conditional_linear

  # Quantized estimator parameters
  n_bins: 32
  temperature: 0.1

  train:
    batch_size: 128
    valid_percentage: 0.1
    early_stopping: false
    lr_annealing: false
    max_epochs: 32
    optimizer_class:
      _partial_: true
      _target_: torch.optim.AdamW
  test:
    batch_size: 128
